swagger: "2.0"
info:
  version: 0.20.4
  title: DebiAI_BACKEND_API
  description: DebiAI backend api
  contact:
    email: debiai@irt-systemx.fr
  license:
    name: Apache 2.0
    url: https://www.apache.org/licenses/LICENSE-2.0.html
paths:
  /version:
    get:
      summary: Ping to check if the backend is running
      operationId: controller.projects.ping
      responses:
        200:
          description: The server is online

  # Data providers
  /data-providers:
    get:
      summary: Get data providers list and status
      tags: [Data Providers]
      operationId: controller.dataProviders.get_data_providers
      responses:
        200:
          description: List of data providers
          schema:
            type: array
            items:
              $ref: "#/definitions/dataProvider"

    post:
      summary: Add data provider to data providers list
      tags: [Data Providers]
      operationId: controller.dataProviders.post_data_providers
      parameters:
        - name: data
          in: body
          schema:
            type: object
            required:
              - name
              - type
            properties:
              name:
                type: string
                description: The name of the data Provider
              type:
                type: string
                description: Type of the data Provider (Web)
              url:
                type: string
                description: The url of the new data Provider if type is Web
      responses:
        204:
          description: Data provider added to the list
        400:
          description: Bad request on data

  /data-providers/{dataProviderId}:
    delete:
      summary: Delete data providers from the list
      tags: [Data Providers]
      operationId: controller.dataProviders.delete_data_providers
      parameters:
        - name: dataProviderId
          in: path
          type: string
          required: true
      responses:
        204:
          description: Data provider deleted
        400:
          description: The Data provider id must not be null
        404:
          description: The data provider doesn't exist
  
    get:
      summary: Get general informations about a data provider, like his version or the max number sample for each type of request
      tags: [Data Providers]
      operationId: controller.dataProviders.get_data_provider_info
      parameters:
        - name: dataProviderId
          in: path
          type: string
          required: true
      responses:
        200:
          description: The info of the data provider
          schema:
            type: object
            required:
              - version
            properties:
              version:
                type: string
              maxSampleIdByRequest:
                type: integer
              maxSampleDataByRequest:
                type: integer
              maxResultByRequest:
                type: integer
        400:
          description: The Data provider id must not be null
        404:
          description: The data provider doesn't exist

  # Projects
  /projects:
    get:
      summary: Get the projects overview
      tags: [Project]
      operationId: controller.projects.get_projects
      responses:
        200:
          description: List of project overviews
          schema:
            type: array
            items:
              $ref: "#/definitions/projectOverview"

    post:
      summary: Post a new project
      tags: [Project]
      operationId: controller.pythonModuleDp.post_project
      parameters:
        - name: data
          in: body
          schema:
            type: object
            required:
              - projectName
            properties:
              projectName:
                type: string
                description: The project name
              blockLevelInfo:
                type: array
                items:
                  $ref: "#/definitions/blockLevelInfo"
                description: List of the block level info

      responses:
        200:
          description: project created, the project ID is returned
          schema:
            type: object
            required:
              - projectId
            properties:
              projectId:
                type: string
        400:
          description: The project name must not be null
        401:
          description: The project name is too long
        402:
          description: The project name contain invalid characters
        403:
          description: A project with the same name already exist

  /data-providers/{dataProviderId}/projects/{projectId}:
    get:
      summary: Get project name, nb of models & nb of selections (overviews of a project)
      tags: [Project]
      operationId: controller.projects.get_project
      parameters:
        - name: dataProviderId
          in: path
          type: string
          required: true
        - name: projectId
          in: path
          type: string
          required: true
      responses:
        200:
          description: project
          schema:
            $ref: "#/definitions/project"

    delete:
      summary: remove a project from ID
      tags: [Project]
      operationId: controller.projects.delete_project
      parameters:
        - name: dataProviderId
          in: path
          type: string
          required: true
        - name: projectId
          in: path
          type: string
          required: true
      responses:
        200:
          description: project deleted
        404:
          description: project doesn't exist

  #Â BlockLevels
  /data-providers/{dataProviderId}/projects/{projectId}/blocklevels:
    post:
      summary: add a new data blocks level structure
      tags: [Project]
      operationId: controller.pythonModuleDp.post_blocklevels
      parameters:
        - name: dataProviderId
          in: path
          type: string
          required: true
        - name: projectId
          in: path
          type: string
          required: true
        - name: blocklevels
          in: body
          schema:
            type: array
            items:
              type: object
              properties:
                name:
                  type: string
                groundTruth:
                  type: array
                  items:
                    type: object
                    properties:
                      name:
                        type: string
                      type:
                        type: string
                inputs:
                  type: array
                  items:
                    type: object
                    properties:
                      name:
                        type: string
                      type:
                        type: string
                contexts:
                  type: array
                  items:
                    type: object
                    properties:
                      name:
                        type: string
                      type:
                        type: string
              minItems: 1
          required: true
      responses:
        200:
          schema:
            type: object
          description: Block tructure added, the block structure is returned

  /data-providers/{dataProviderId}/projects/{projectId}/resultsStructure:
    post:
      summary: add a new expected results structure
      tags: [Project]
      operationId: controller.pythonModuleDp.post_resultsStructure
      parameters:
        - name: dataProviderId
          in: path
          type: string
          required: true
        - name: projectId
          in: path
          type: string
          required: true
        - name: resultStructure
          in: body
          schema:
            type: array
            items:
              type: object
              required:
                - name
                - type
              properties:
                name:
                  type:
                    - number
                    - string
                type:
                  type: string
                  description: text, number or bool
                default:
                  type:
                    - number
                    - string
                    - boolean
          required: true
      responses:
        200:
          schema:
            type: object
          description: Results structure added, the resultStructure is returned
        404:
          description: The project does not exist
        403:
          description: The result structure already exist

  # Models
  /data-providers/{dataProviderId}/projects/{projectId}/models:
    post:
      summary: add a model
      tags: [Model]
      operationId: controller.models.post_model
      parameters:
        - name: dataProviderId
          in: path
          type: string
          required: true
        - name: projectId
          in: path
          type: string
          required: true
        - name: data
          in: body
          schema:
            type: object
            required:
              - name
            properties:
              name:
                type: string
              metadata:
                type: object
                description: Model metadata - key value list
          required: true
      responses:
        200:
          description: Model added
        409:
          description: Warning - Model already exist
        402:
          description: Model name contain prohibed caracters
        404:
          description: Project not found

  /data-providers/{dataProviderId}/projects/{projectId}/models/{modelId}:
    delete:
      summary: remove a model
      tags: [Model]
      operationId: controller.models.delete_model
      parameters:
        - name: dataProviderId
          in: path
          type: string
          required: true
        - name: projectId
          in: path
          type: string
          required: true
        - name: modelId
          in: path
          type: string
          required: true
      responses:
        200:
          description: model deleted
        404:
          description: model or project doesn't exist

  /data-providers/{dataProviderId}/projects/{projectId}/models/{modelId}/resultsDict:
    post:
      summary: Add a results to a model
      tags: [Model]
      operationId: controller.pythonModuleDp.add_results_dict
      parameters:
        - name: dataProviderId
          in: path
          type: string
          required: true
        - name: projectId
          in: path
          type: string
          required: true
        - name: modelId
          in: path
          type: string
          required: true
        - name: data
          description: Tree object with existing block references, the end of the tree need to include the expected results in the block structure
          in: body
          required: true
          schema:
            type: object
            required:
              - results
            properties:
              results:
                type: object
              expected_results_order:
                description: order of the given results array, by default is the project result structure
                type: array

      responses:
        200:
          description: model results added
        403:
          description: Block not found
        404:
          description: model or project doesn't exist

  /data-providers/{dataProviderId}/projects/{projectId}/models/{modelId}/getModelResults:
    post:
      summary: Get the model results from a sample list
      tags: [Model]
      operationId: controller.models.get_results
      parameters:
        - name: dataProviderId
          in: path
          type: string
          required: true
        - name: projectId
          in: path
          type: string
          required: true
        - name: modelId
          in: path
          type: string
          required: true
        - name: data
          in: body
          required: true
          schema:
            type: object
            required:
              - sampleIds
            properties:
              sampleIds:
                description: List of sample ID
                items:
                  type: [string, integer, number]
      responses:
        200:
          description: model results
          schema:
            type: object
            additionalProperties:
              type: array
              description: List of results ordered the same way as the project expected results
        404:
          description: model or project doesn't exist

  # Samples
  /data-providers/{dataProviderId}/projects/{projectId}/samples:
    post:
      summary: get the project sampleId list, can be filtered by selections, models, or both
      tags: [Samples]
      operationId: controller.samples.get_list
      parameters:
        - name: dataProviderId
          in: path
          type: string
          required: true
        - name: projectId
          in: path
          type: string
          description: project ID
          required: true

        - name: data
          in: body
          schema:
            type: object
            properties:
              selectionIds:
                type: array
                items:
                  type: string
                description: To get the samples that are parts of those given selection
              selectionIntersection:
                type: boolean
                description: To get only the the samples that are in all of the selections

              modelIds:
                type: array
                items:
                  type: string
                description: To get the samples that those models have been evaluated on
              commonResults:
                type: boolean
                description: To get only the the samples that have been evaluated on a common sample

              from:
                type: integer
                description: Where we start the selection in case of over 10 000 samples
                minimum: 0
              to:
                type: integer
                description: Where we stop the selection in case of over 10 000 samples
                minimum: 0
      responses:
        200:
          description: List of the project sample id
          schema:
            type: object
            properties:
              samples:
                type: array
                items:
                  type: string
                description: List of samples
              nbFromSelection:
                type: integer
                description: The number of samples that are from the selection (and not the models)
        404:
          description: project doesn't exist

  /data-providers/{dataProviderId}/projects/{projectId}/selectionSamples/{selectionId}:
    get:
      summary: get the project selection sampleId list
      tags: [Samples]
      operationId: controller.samples.get_selection_list
      parameters:
        - name: dataProviderId
          in: path
          type: string
          required: true
        - name: projectId
          in: path
          type: string
          description: project ID
          required: true
        - name: selectionId
          in: path
          type: string
          description: selection ID
          required: true

      responses:
        200:
          description: List of the project sample id
          schema:
            type: array
            items:
              type: string
        404:
          description: project or selection doesn't exist

  # Blocks
  /data-providers/{dataProviderId}/projects/{projectId}/blocks:
    post:
      summary: add a tree to an existing project block tree
      tags: [Block]
      operationId: controller.pythonModuleDp.post_block_tree
      parameters:
        - name: dataProviderId
          in: path
          type: string
          required: true
        - name: projectId
          in: path
          type: string
          description: project ID
          required: true

        - name: data
          in: body
          schema:
            type: object
            required:
              - blockTree
            properties:
              blockTree:
                $ref: "#/definitions/blockTree"
          required: true

      responses:
        200:
          description: Block tree added
        403:
          description: Invalid parameters
        404:
          description: Project not found

  /data-providers/{dataProviderId}/projects/{projectId}/blocksFromSampleIds:
    post:
      summary: get a project tree form a sample list
      tags: [Block]
      operationId: controller.data.get_data
      parameters:
        - name: dataProviderId
          in: path
          type: string
          required: true
        - name: projectId
          in: path
          type: string
          description: project ID
          required: true

        - name: data
          in: body
          schema:
            type: object
            required:
              - sampleIds
            properties:
              sampleIds:
                type: array
                items:
                  type: [string, integer, number]
          required: true

      responses:
        200:
          description: Block tree with sample
          schema:
            type: object
        404:
          description: Project or one of the models not found

  # Requests
  /data-providers/{dataProviderId}/projects/{projectId}/requests/:
    get:
      summary: Get the project requests
      tags: [Requests]
      operationId: controller.requests.get_requests
      parameters:
        - name: dataProviderId
          in: path
          type: string
          required: true
        - name: projectId
          in: path
          type: string
          required: true
      responses:
        200:
          description: Project requests
          schema:
            type: array
            items:
              $ref: "#/definitions/request"

    post:
      summary: add a request
      tags: [Requests]
      operationId: controller.requests.post_request
      parameters:
        - name: dataProviderId
          in: path
          type: string
          required: true
        - name: projectId
          in: path
          type: string
          required: true
        - name: data
          in: body
          schema:
            type: object
            required:
              - requestName
              - filters
            properties:
              requestName:
                type: string
              filters:
                type: array
                items:
                  type: object
                  required:
                    - type
                    - columnLabel
                  properties:
                    type:
                      type: string
                    columnLabel:
                      type: string
                    inverted:
                      type: boolean
                      default: false
                  description: can be of type 'values' or 'intervals'. 'values'
                    filers need to have a 'values' key with an array of values,
                    'intervals' filters need to have an 'intervals' key with a list
                    of {min, max} intervals
      responses:
        200:
          schema:
            $ref: "#/definitions/request"
          description: request added, the request is returned

  /data-providers/{dataProviderId}/projects/{projectId}/requests/{requestId}/newSelection:
    post:
      summary: Create a selection from a request filters
      tags: [Requests]
      operationId: controller.requests.create_selection
      parameters:
        - name: dataProviderId
          in: path
          type: string
          required: true
        - name: projectId
          in: path
          type: string
          required: true
        - name: requestId
          in: path
          type: string
          required: true
        - name: data
          in: body
          schema:
            type: object
            required:
              - selectionName
            properties:
              selectionName:
                type: string
      responses:
        200:
          description: selection created

  /data-providers/{dataProviderId}/projects/{projectId}/requests/{requestId}:
    get:
      summary: Get a project request
      tags: [Requests]
      operationId: controller.requests.get_request
      parameters:
        - name: dataProviderId
          in: path
          type: string
          required: true
        - name: projectId
          in: path
          type: string
          required: true
        - name: requestId
          in: path
          type: string
          required: true
      responses:
        200:
          description: Project request
          schema:
            $ref: "#/definitions/request"
    delete:
      summary: delete a request
      tags: [Requests]
      operationId: controller.requests.delete_request
      parameters:
        - name: dataProviderId
          in: path
          type: string
          required: true
        - name: projectId
          in: path
          type: string
          required: true
        - name: requestId
          in: path
          type: string
          required: true
      responses:
        200:
          description: request deleted

  #Â Selections
  /data-providers/{dataProviderId}/projects/{projectId}/selections/:
    get:
      summary: Get the project selections
      tags: [Selection]
      operationId: controller.selection.get_selections
      parameters:
        - name: dataProviderId
          in: path
          type: string
          required: true
        - name: projectId
          in: path
          type: string
          required: true
      responses:
        200:
          description: Project selections
          schema:
            type: array
            items:
              $ref: "#/definitions/selection"

    post:
      summary: add a selection
      tags: [Selection]
      operationId: controller.selection.post_selection
      parameters:
        - name: dataProviderId
          in: path
          type: string
          required: true
        - name: projectId
          in: path
          type: string
          required: true
        - name: data
          in: body
          schema:
            type: object
            required:
              - sampleHashList
              - selectionName
            properties:
              sampleHashList:
                type: array
                items:
                  type: string
                description: List of the selection sample id (hash)
              selectionName:
                type: string
              requestDescription:
                type: string
                x-nullable: true
              requestId:
                type: string
                description: Id of the request that has created the selection.
                x-nullable: true
      responses:
        200:
          description: selection added
          schema:
            type: object

  /data-providers/{dataProviderId}/projects/{projectId}/selections/{selectionId}:
    delete:
      summary: delete a selection
      tags: [Selection]
      operationId: controller.selection.delete_selection
      parameters:
        - name: dataProviderId
          in: path
          type: string
          required: true
        - name: projectId
          in: path
          type: string
          required: true
        - name: selectionId
          in: path
          type: string
          required: true
      responses:
        200:
          description: selection deleted

  # Widget configuration
  /app/widget-configurations/:
    get:
      summary: Get all widget configurations overview,
        return the number of configurations for each widget
      tags: [Widget configurations]
      operationId: controller.widgetConfigurations.get_all_configurations
      responses:
        200:
          description: Widget configurations number for each widget
          schema:
            type: object
            description: Object with widget title as key and number of
              configurations as value
            additionalProperties:
              type: integer
              minimum: 0

  /app/widgets/{widgetKey}/configurations:
    get:
      summary: Get the widget configurations
      tags: [Widget configurations]
      operationId: controller.widgetConfigurations.get_widget_configurations
      parameters:
        - name: widgetKey
          in: path
          description: Title of the wigdet linked to the configuration
          type: string
          required: true
          minLength: 1
      responses:
        200:
          description: Widget configurations list
          schema:
            type: array
            items:
              type: object
              required:
                - id
                - name
                - projectId
                - dataProviderId
                - configuration
              properties:
                id:
                  type: string
                name:
                  type: string
                description:
                  type: string
                projectId:
                  type: string
                  description: Id of the project linked to the configuration
                dataProviderId:
                  type: string
                  description: Id of the data provider linked to the project id
                creationDate:
                  type: string
                configuration:
                  type: object
                  description: Key value list with the configuration, specific to the widget
    post:
      summary: Add a widget configuration
      tags: [Widget configurations]
      operationId: controller.widgetConfigurations.post_configuration
      parameters:
        - name: widgetKey
          in: path
          required: true
          type: string
          minLength: 1

        - name: data
          in: body
          required: true
          schema:
            type: object
            required:
              - name
              - projectId
              - dataProviderId
              - configuration
            properties:
              name:
                type: string
                description: Name of the configuration
                maxLength: 50
                minLength: 1
              projectId:
                type: string
                description: Id of the project linked to the configuration
              dataProviderId:
                type: string
                description: Id of the data provider linked to the project id
              description:
                type: string
              configuration:
                type: object
                description: Key value list with the configuration, specific to the widget
                maxProperties: 15

      responses:
        204:
          description: Widget configuration saved

  /app/widgets/{widgetKey}/configurations/{id}:
    delete:
      summary: Delete a widget configuration
      tags: [Widget configurations]
      operationId: controller.widgetConfigurations.delete_configuration
      parameters:
        - name: widgetKey
          in: path
          type: string
          required: true
          minLength: 1
        - name: id
          in: path
          type: string
          required: true
          description: Id of the configuration to delete
          minLength: 1
      responses:
        204:
          description: Widget configuration saved
        404:
          description: Widget title or configuration not found

  # Tags
  /data-providers/{dataProviderId}/projects/{projectId}/tags:
    post:
      summary: Add a tag to a project
      tags: [Tags]
      operationId: controller.tags.post_tag
      parameters:
        - name: dataProviderId
          in: path
          type: string
          required: true
        - name: projectId
          in: path
          type: string
          required: true
        - name: data
          in: body
          schema:
            type: object
            required:
              - tagName
              - tagHash
            properties:
              tagName:
                type: string
                description: Tag name
                minLength: 1
              tagHash:
                type: object
                description: key value ; key is the sample hash, value is the tag value
          required: true
      responses:
        200:
          description: Tag added or updated
        404:
          description: Project not found

    get:
      summary: Get project tags
      tags: [Tags]
      operationId: controller.tags.get_tags
      parameters:
        - name: dataProviderId
          in: path
          type: string
          required: true
        - name: projectId
          in: path
          type: string
          required: true
      responses:
        200:
          description: Tag overview list
          schema:
            type: array
            items:
              $ref: "#/definitions/tag"

  /data-providers/{dataProviderId}/projects/{projectId}/tags/{tagId}:
    get:
      summary: Get a tag from Id
      tags: [Tags]
      operationId: controller.tags.get_tag
      parameters:
        - name: dataProviderId
          in: path
          type: string
          required: true
        - name: projectId
          in: path
          type: string
          required: true
        - name: tagId
          in: path
          type: string
          required: true
      responses:
        200:
          description: Tag
          schema:
            $ref: "#/definitions/tag"
    delete:
      summary: Delete a tag
      tags: [Tags]
      operationId: controller.tags.delete_tag
      parameters:
        - name: dataProviderId
          in: path
          type: string
          required: true
        - name: projectId
          in: path
          type: string
          required: true
        - name: tagId
          in: path
          type: string
          required: true
      responses:
        200:
          description: Tag deleted
        404:
          description: Project or tag not found

  /data-providers/{dataProviderId}/projects/{projectId}/tags/{tagId}/samples/{tagValue}:
    get:
      summary: Get a sample tree from a tag and a value
      tags: [Tags]
      operationId: controller.tags.get_tag_sample_tree
      parameters:
        - name: dataProviderId
          in: path
          type: string
          required: true
        - name: projectId
          in: path
          type: string
          required: true
        - name: tagId
          in: path
          type: string
          required: true
        - name: tagValue
          in: path
          type: integer
          required: true
      responses:
        200:
          description: Sample tree
          schema:
            type: object

  # Data export
  /app/exportMethods:
    get:
      summary: Get the application export methods
      tags: [Export]
      operationId: controller.exportMethods.get_export_methods
      responses:
        200:
          description: Export method list
          schema:
            type: array
            items:
              type: object
              required:
                - type
                - name
                - parameters
                - parameterNames
              properties:
                type:
                  type: string
                  description: Export method type
                name:
                  type: string
                  description: Export method name
                  minLength: 1
                parameters:
                  type: array
                  description: Export method parameters
                parametersNames:
                  type: array
                  description: Name of the export method parameters according to the export type

    post:
      summary: Create an export method for the app
      tags: [Export]
      operationId: controller.exportMethods.post_export_method
      parameters:
        - name: data
          in: body
          schema:
            type: object
            required:
              - type
              - name
              - parameters
            properties:
              type:
                type: string
                description: Export method type
              name:
                type: string
                description: Export method name
                minLength: 1
              parameters:
                type: array
                description: Export method parameters, can be anything as long as the export method type can read it
          required: true
      responses:
        200:
          description: Export method added
        400:
          description: Wrong type or parameters

  /app/exportMethods/{exportMethodId}:
    delete:
      summary: Remove an export method for the app
      tags: [Export]
      operationId: controller.exportMethods.delete_export_method
      parameters:
        - name: exportMethodId
          in: path
          type: string
          required: true
      responses:
        200:
          description: Export method removed
        404:
          description: Unknown export method

  /app/exportMethods/{exportMethodId}/exportData:
    post:
      summary: Export data with an export method
      tags: [Export]
      operationId: controller.exportMethods.exportData
      parameters:
        - name: exportMethodId
          in: path
          type: string
          required: true
        - name: data
          in: body
          schema:
            type: object
      responses:
        200:
          description: Data exported

  /data-providers/{dataProviderId}/projects/{projectId}/exportSelection:
    post:
      summary: Export a selected sample id list from an export method
      tags: [Export]
      operationId: controller.exportMethods.exportSelection
      parameters:
        - name: dataProviderId
          in: path
          type: string
          required: true
        - name: projectId
          in: path
          type: string
          required: true
        - name: data
          in: body
          schema:
            type: object
            required:
              - sampleHashList
              - selectionName
              - exportMethodId
            properties:
              sampleHashList:
                type: array
                items:
                  type: string
                description: List of the selected sample id (hash)
              selectionName:
                type: string
              exportMethodId:
                type: string
              annotationValue:
                type: string
                description: Any value set by the user
      responses:
        200:
          description: Selection exported

  #Â Statistical operations
  /statisticalOperations/pearsonCorrelation:
    post:
      summary: Calculate pearson correlation between rows
      tags: [Statistical operations]
      operationId: controller.statisticalOperations.pearsonCorrelation
      parameters:
        - name: data
          in: body
          description: Array of rows with the same sizes (discrete & continuous)
          schema:
            type: array
            items:
              type: array
              items:
                type: number

      responses:
        200:
          description: pearson correlation matrix
          schema:
            type: array
            items:
              type: array
              items:
                type: array
                items:
                  type: number

        403:
          description: Invalid Input array, not the same size

  /statisticalOperations/spearmanCorrelation:
    post:
      summary: Calculate spearman correlation between rows
      tags: [Statistical operations]
      operationId: controller.statisticalOperations.spearmanCorrelation
      parameters:
        - name: data
          in: body
          description: Array of rows with the same sizes (discrete & continuous)
          schema:
            type: array
            items:
              type: array
              items:
                type: number

      responses:
        200:
          description: spearman correlation matrix
          schema:
            type: array
            items:
              type: array
              items:
                type: array
                items:
                  type: number

        403:
          description: Invalid Input array, not the same size

  /statisticalOperations/continuousMutualInformation:
    post:
      summary: Calculate mutual informations
      tags: [Statistical operations]
      operationId: controller.statisticalOperations.mutualInformation
      parameters:
        - name: data
          in: body
          description: mutual information matrix
          schema:
            type: object
            required:
              - list_continuous
              - list_discrete
            properties:
              k:
                type: integer
                description: number of neighbors
              base:
                type: integer
                description: takes 2 (unit =bits), 10 (unit= nats)
              list_continuous:
                type: array
                items:
                  type: array
                  items:
                    type: number
                description: Array of rows with the same sizes (continuous only)
              list_discrete:
                type: array
                items:
                  type: array
                  items:
                    type: number
                description: Array of rows with the same sizes (dicrete only)
              normalise:
                type: string
                default: "max"
                description: This parameter is used to normalise the mutual information coefficient, it takes either 'max' or 'min' or 'square root' or 'mean' or 'none'

      responses:
        200:
          description: mutual information matrix
          schema:
            type: array
            items:
              type: array
              items:
                type: number
        403:
          description: Invalid Input array, not the same size

  /statisticalOperations/higherDimensionMutualInformation:
    post:
      summary: Calculate the mutual information between variables
      tags: [Statistical operations]
      operationId: controller.statisticalOperations.higherDimensionMutualInformation
      parameters:
        - name: data
          in: body
          schema:
            type: object
            required:
              - X
              - k
            properties:
              k:
                type: integer
                description: number of neighbors (must be < to len(X))
              base:
                type: integer
                description: takes 2 (unit =bits), 10 (unit= nats)
                default: 2
              X:
                type: array
                items:
                  type: array
                  items:
                    type: number
                description: list of list of the variables, it can take more than 2 variables

      responses:
        200:
          description: mutual information between the variables
          schema:
            type: number
        403:
          description: Invalid Input

  /statisticalOperations/continuousAndHigherDimensionMutualInformation:
    post:
      summary: Calculate matrix mutual informations and the higher Dimension
      tags: [Statistical operations]
      operationId: controller.statisticalOperations.mutualAndHigherInformation
      parameters:
        - name: data
          in: body
          description: mutual information matrix
          schema:
            type: object
            required:
              - list_continuous
              - list_discrete
              - k
            properties:
              k:
                type: integer
                description: number of neighbors
              base:
                type: integer
                description: takes 2 (unit =bits), 10 (unit= nats)
              list_continuous:
                type: array
                items:
                  type: array
                  items:
                    type: number
                description: Array of rows with the same sizes (continuous only)
              list_discrete:
                type: array
                items:
                  type: array
                  items:
                    type: number
                description: Array of rows with the same sizes (dicrete only)
              normalise:
                type: string
                default: "max"
                description: This parameter is used to normalise the mutual information coefficient, it takes either 'max' or 'min' or 'square root' or 'mean' or 'none'

      responses:
        200:
          description: mutual information matrix
          schema:
            type: array
            items:
              type: array
              items:
                type: number
        403:
          description: Invalid Input array, not the same size

definitions:
  # Projects
  projectOverview:
    type: object
    required:
      - id
      - dataProviderId
      - name
    properties:
      id:
        type: string
        description: project ID

      dataProviderId:
        type: string
        description: project data provider ID

      name:
        type: string
        description: project name

      nbModels:
        type: integer
        description: number of Models

      nbSelections:
        type: integer
        description: number of selections

      creationDate:
        type: string
        format: date-time
        description: creation date

      updateDate:
        type: string
        format: date-time
        description: last update date

  project:
    type: object
    required:
      - name
    properties:
      name:
        type: string
        description: project ID

      modelOverviews:
        type: array
        items:
          $ref: "#/definitions/modelOverview"
        description: list of the model overviews

      blockLevelInfo:
        type: array
        items:
          $ref: "#/definitions/blockLevelInfo"
        description: list of the projects blockLevelInfo that describe the project tree

  blockLevelInfo:
    type: object
    required:
      - name
    properties:
      name:
        type: string
        description: block level name
        example: file

  # Artefacts
  artefact:
    type: object
    required:
      - name
    properties:
      name:
        type: string
      creationDate:
        type: string
        format: date-time
      updateDate:
        type: string
        format: date-time
      version:
        type: string
      metaDataList:
        type: object
        additionalProperties:
          type: string
        example:
          meteo: soleil
          temperature: 50

  # Models
  modelOverview:
    type: object
    required:
      - name
      - id
    properties:
      name:
        type: string
      id:
        type: string
      nbEvaluatedSamples:
        type: integer
      updateDate:
        type: string
        format: date-time
      creationDate:
        type: string
        format: date-time
      metadata:
        type: object

  model:
    allOf:
      - $ref: "#/definitions/artefact"
      - type: object
        properties:
          hyperParameters:
            type: array
            items:
              type: string
          trainingLogs:
            type: array
            items:
              type: string

  # Selections and requests
  selection:
    allOf:
      - $ref: "#/definitions/artefact"
      - type: object
        properties:
          nbSamples:
            type: integer

  request:
    allOf:
      - $ref: "#/definitions/artefact"
      - type: object
        required:
          - filters
        properties:
          filters:
            type: array
            items:
              type: object
              required:
                - type
                - columnLabel
              properties:
                type:
                  type: string
                columnLabel:
                  type: string
            description: Can be of type 'values' of 'intervals', 'values'
              filters have a 'values' key that is a list of text or numbers
              , 'intervals' filters have an 'interval' key that is a list of
              {min, max} intervals

  # Tags
  tag:
    allOf:
      - $ref: "#/definitions/artefact"
      - type: object
        required:
          - tags
        properties:
          tags:
            type: object
            description: key is samplehash and value is an integer

  # DataTypes
  dataType:
    type: object
    properties:
      gdtList:
        type: array
        items:
          type: object
        description: list of ground thruth (key - value)

      inputList:
        type: array
        items:
          type: object
        description: list of inputs (key - value)

      contextList:
        type: array
        items:
          type: object
        description: list of context (key - value)

  dataTypeOut:
    allOf:
      - $ref: "#/definitions/dataType"
      - type: object
        required:
          - id
        properties:
          id:
            type: string

  # block & sample

  block:
    allOf:
      - $ref: "#/definitions/dataType"
      - type: object
        required:
          - name
        properties:
          name:
            type: string

  blockOverview:
    type: object
    required:
      - name
    properties:
      name:
        type: string
        description: name of the block

  sample:
    allOf:
      - $ref: "#/definitions/artefact"
      - type: object

  blockTree:
    type: array
    items:
      $ref: "#/definitions/block"

  # Data providers
  dataProvider:
    type: object
    properties:
      name:
        type: string
      url:
        type: string
      status:
        type: boolean
      type:
        type: string
